SET mapreduce.job.queuename=priority;

-- getting newbie data staring in 2013


DROP TABLE IF EXISTS newcomer.user_start;
CREATE TABLE newcomer.user_start
ROW FORMAT DELIMITED
      FIELDS TERMINATED BY '\t'
      LINES TERMINATED BY '\n'
STORED AS TEXTFILE
AS SELECT
      *
FROM
      enwiki.user_start
WHERE
      registration_day >= '20110101'
      AND registration_day <= '20151231';



DROP TABLE IF EXISTS newcomer.daily_revision_counts;
CREATE TABLE newcomer.daily_revision_counts
ROW FORMAT DELIMITED
      FIELDS TERMINATED BY '\t'
      LINES TERMINATED BY '\n'
STORED AS TEXTFILE
AS SELECT
      e.*
FROM
      enwiki.daily_revision_counts e
JOIN
      (SELECT DISTINCT(user_id) FROM newcomer.user_start ) u
ON (e.user_id = u.user_id)
WHERE
      day >= '20110101'
      AND day <= '20151231';



DROP TABLE IF EXISTS newcomer.user_warnings;
CREATE TABLE newcomer.user_warnings
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\t'
LINES TERMINATED BY '\n' 
STORED AS TEXTFILE
AS SELECT
    w.*
FROM
    enwiki.user_warnings w
JOIN
      (SELECT DISTINCT(user_text) FROM newcomer.user_start) u
ON (w.page_title = u.user_text)
WHERE
    rev_timestamp >= '2011-01-01'
    AND rev_timestamp <= '2015-12-31';



